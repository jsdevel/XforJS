!function(){/*

 Copyright 2012 Joseph Spencer.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 Version: 1.0.1

 For demos and docs visit http://jsdevel.github.com/XforJS/
 For viewing source visit http://github.com/jsdevel/XforJS/
*/
function e(a){throw a;}var g=!0,l=!1;function m(){return function(){}}function n(a){return function(){return a}}var q;function r(a,b){a.prototype=new b;a.prototype.constructor=a}
var aa=/^((?:[^\}\\]|\\[\}\\])+\.xjs)/,ba=/^((?:[^#'\{\\]|\\(?:#|'|\\|\{))+)/,u=/^([a-zA-Z$_](?:[\w$]+)?)/,ca=/^([a-zA-Z$_](?:[\w$]+)?(?:(?:\.[a-zA-Z$_](?:[\w$]+)?)+)?)/,da=/^([a-zA-Z$_](?:[\w$]+)?(?:\.[a-zA-Z$_](?:[\w$]+)?)+)/,ea=/^(\|(?:asc|desc))(?![\w$])/,fa=/^(\|[cCin]{0,4})(?![\w$])/,ga=/^((?:\s|#(?:[^\r\n]+)?(?:\r?\n))+)/,ha=/(>|<)\s+|\s+(>|<)/g,ia=/^((?:\s|#(?:[^\r\n]+)?(?:\r?\n))+)(?=\{)/,ja=/^((?:(?!\{\/text\})[\s\S])+)(?=\{\/text\})/,ka=/^@([a-zA-Z$_](?:[\w$]+)?)\s*[\.\[]/,la=/^(@([a-zA-Z$_](?:[\w$]+)?))/,
ma=/^(\{call\s+)/,na=/^(\{\/call\})/,oa=/^(\{foreach\s+)/,pa=/^(\{\/foreach\})/,qa=/^(\{if\s+)/,ra=/^(\{\/if\})/,sa=/^(\{import\s+)/,ta=/^(\{log\s+)/,ua=/^(\{namespace\s+)/,x=/^(\{param\s+)/,va=/^(\{sort\s+)/,wa=/^(\{template\s+)/,xa=/^(\{\/template\})/,ya=/^(\{text\})/,za=/^(\{\/text\})/,y=/^(\{var\s+)/,Aa=/^(\{:elif\s+)/,Ba=/^(count\()/,Ca=/^(current\(\))/,Da=/^(last\(\))/,Ea=/^(name\(\))/,Fa=/^(position\(\))/,Ga=/^(false|true)(?![\w$])/,Ha=/^((?:0x(?=([0-9A-Fa-f]+))\2(?!\.)|(?=(0(?![0-9])|[1-9][0-9]*))\3(?!x)(?:\.[0-9]+)?)(?:[eE][-+][0-9]+)?)/,
Ia=/^(null)(?![\w$])/,Ja=/^((['"])(?=((?:(?:(?!\2|\r?\n|\\)[\s\S]|\\(?:\\|\2|\r?\n))+)?))\3\2)/,Ka={"break":g,"case":g,"catch":g,"continue":g,"debugger":g,"default":g,"delete":g,"do":g,"else":g,"finally":g,"for":g,"function":g,"if":g,"in":g,"instanceof":g,"new":g,"return":g,"switch":g,"this":g,"throw":g,"try":g,"typeof":g,"var":g,"void":g,"while":g,"with":g,"class":g,"const":g,"enum":g,"export":g,"extends":g,"import":g,"super":g,"implements":g,"interface":g,let:g,"package":g,"private":g,"protected":g,
"public":g,"static":g,yield:g};function La(a){a=a.split(".");for(var b=0,d=a.length;b<d;b++)Ka[a[b]]&&e("Usage of the following ECMAScript reserved word is not allowed: "+a[b])}function Ma(a){var b=require("fs"),d=require("path");(!a||"string"!==typeof a)&&e("inputFilePath must be a string.");a=d.normalize(a.replace(/^\s+|\s+$/g,""));/\.xjs$/.test(a)||e("inputFilePath must end with '.xjs'.");b.existsSync(a)||e("The following path doesn't exist: \n   "+a);return d.resolve(a)}
var z="b",A="x",B="N",Na="A",C="L",Oa="n",Pa="P",Qa="M",Ra="O",D="B",Sa="C",Ta="X",Ua="F",E="G",Va="V",Wa="S",Xa={getXforJSLib:n("\nxforj={\n   C:(function(f){var o,c=0,n;try{o=f()}catch(e){o=f}if(!!o&&typeof(o)==='object'){if(o.slice&&o.join&&o.pop){return o.length>>>0;}else{for(n in o){c++;}}}return c}),\n   X:(function(q,p,l,g,a,t){q.exec('a');p.exec('a');l.exec('a');g.exec('a');a.exec('a');t.exec('a');return function(s){if(typeof(s)==='string'){return s.replace(a,'&amp;').replace(q,'&#34;').replace(p,'&#39;').replace(t,'&#96;').replace(l,'&lt;').replace(g,'&gt;');}return s;}})(/\"/g,/'/g,/</g,/>/g,/&(?![a-zA-Z]+;|#[0-9]+;)/g,/`/g),\n   F:(function(o,c,so,n,p,i){var j=0,l,m;if(!!o&&typeof(o)==='object'&&typeof(c)==='function'){l=o.length;if(so!==void(0))o.sort(function(c,d){var av=c.v,bv=d.v,a=c.k,b=d.k,al=c.l,bl=d.l,aisu=al&&al!==av,bisu=bl&&bl!==bv,at=c.t,bt=d.t,an=at==='number',bn=bt==='number';if(av===bv){return -1;}if((an&&!bn)||(!an&&bn)){if(n){return at>bt?1:-1;}return at>bt?-1:1;}if(an&&bn){if(so){return av-bv;}else{return bv-av;}}if(!al&&!bl)return -1;if(!al&&bl)return 1;if(al&&!bl)return -1;if(!p){if(so){if(i){if(al===bl){return -1;}else{return al>bl?1:-1;}}else{return av>bv?1:-1;}}else{if(i){if(al===bl){return -1;}return al>bl?-1:1;}else{if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}return av>bv?-1:1;}}}if(p===1){if(so){if(!i){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return av>bv?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return -1;}}else{return al>bl?-1:1;}}}}if(p===2){if(so){if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?1:-1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?-1:1;}}}}});for(j;j<l;j++){m=o[j];c(m.c,j+1,o.length,m.n)}}}),\n   V:(function(v){try{return v()}catch(e){return typeof(v)==='function'?void(0):v}}),\n   G:(function(l,s){var r=[],a,v,o,t;try{o=l()}catch(e){o=l}if(!!o&&typeof(o)==='object'){for(a in o){try{v=s(o[a]);t=typeof(v);r.push({n:a,c:o[a],l:t==='string'?v.toLowerCase():'',t:t,v:(t==='string'||t==='number')?v:''});}catch(e){r.push({n:a,c:o[a],s:'',v:'',k:''});}}}return r}),\n   S:(function(){var r=[],i=0,t='numberstringboolean',f=function(s){var y,v;try{v=s();}catch(e){v=s;}y=typeof(v);r[i++]=(t.indexOf(y)>-1)?v:''};f.s=function(){return r.join('')};return f})\n};\n\n"),
xa:n("(function(){var r=[],i=0,t='numberstringboolean',f=function(s){var y,v;try{v=s();}catch(e){v=s;}y=typeof(v);r[i++]=(t.indexOf(y)>-1)?v:''};f.s=function(){return r.join('')};return f})"),wa:n("(function(v){try{return v()}catch(e){return typeof(v)==='function'?void(0):v}})"),ta:n("(function(l,s){var r=[],a,v,o,t;try{o=l()}catch(e){o=l}if(!!o&&typeof(o)==='object'){for(a in o){try{v=s(o[a]);t=typeof(v);r.push({n:a,c:o[a],l:t==='string'?v.toLowerCase():'',t:t,v:(t==='string'||t==='number')?v:''});}catch(e){r.push({n:a,c:o[a],s:'',v:'',k:''});}}}return r})"),
sa:n("(function(o,c,so,n,p,i){var j=0,l,m;if(!!o&&typeof(o)==='object'&&typeof(c)==='function'){l=o.length;if(so!==void(0))o.sort(function(c,d){var av=c.v,bv=d.v,a=c.k,b=d.k,al=c.l,bl=d.l,aisu=al&&al!==av,bisu=bl&&bl!==bv,at=c.t,bt=d.t,an=at==='number',bn=bt==='number';if(av===bv){return -1;}if((an&&!bn)||(!an&&bn)){if(n){return at>bt?1:-1;}return at>bt?-1:1;}if(an&&bn){if(so){return av-bv;}else{return bv-av;}}if(!al&&!bl)return -1;if(!al&&bl)return 1;if(al&&!bl)return -1;if(!p){if(so){if(i){if(al===bl){return -1;}else{return al>bl?1:-1;}}else{return av>bv?1:-1;}}else{if(i){if(al===bl){return -1;}return al>bl?-1:1;}else{if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}return av>bv?-1:1;}}}if(p===1){if(so){if(!i){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return av>bv?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return -1;}}else{return al>bl?-1:1;}}}}if(p===2){if(so){if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?1:-1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?-1:1;}}}}});for(j;j<l;j++){m=o[j];c(m.c,j+1,o.length,m.n)}}})"),
qa:n("(function(f){var o,c=0,n;try{o=f()}catch(e){o=f}if(!!o&&typeof(o)==='object'){if(o.slice&&o.join&&o.pop){return o.length>>>0;}else{for(n in o){c++;}}}return c})"),ra:n("(function(q,p,l,g,a,t){q.exec('a');p.exec('a');l.exec('a');g.exec('a');a.exec('a');t.exec('a');return function(s){if(typeof(s)==='string'){return s.replace(a,'&amp;').replace(q,'&#34;').replace(p,'&#39;').replace(t,'&#96;').replace(l,'&lt;').replace(g,'&gt;');}return s;}})(/\"/g,/'/g,/</g,/>/g,/&(?![a-zA-Z]+;|#[0-9]+;)/g,/`/g)")};
function Ya(a){var b,d,c,h,f,k;(!a||"object"!==typeof a)&&e("args must be an object.");a.useexternal?(b="xforj."+Sa,d="xforj."+Ta,c="xforj."+Ua,h="xforj."+Va,f="xforj."+E,k="xforj."+Wa):(b="(function(f){var o,c=0,n;try{o=f()}catch(e){o=f}if(!!o&&typeof(o)==='object'){if(o.slice&&o.join&&o.pop){return o.length>>>0;}else{for(n in o){c++;}}}return c})",d="(function(q,p,l,g,a,t){q.exec('a');p.exec('a');l.exec('a');g.exec('a');a.exec('a');t.exec('a');return function(s){if(typeof(s)==='string'){return s.replace(a,'&amp;').replace(q,'&#34;').replace(p,'&#39;').replace(t,'&#96;').replace(l,'&lt;').replace(g,'&gt;');}return s;}})(/\"/g,/'/g,/</g,/>/g,/&(?![a-zA-Z]+;|#[0-9]+;)/g,/`/g)",
c="(function(o,c,so,n,p,i){var j=0,l,m;if(!!o&&typeof(o)==='object'&&typeof(c)==='function'){l=o.length;if(so!==void(0))o.sort(function(c,d){var av=c.v,bv=d.v,a=c.k,b=d.k,al=c.l,bl=d.l,aisu=al&&al!==av,bisu=bl&&bl!==bv,at=c.t,bt=d.t,an=at==='number',bn=bt==='number';if(av===bv){return -1;}if((an&&!bn)||(!an&&bn)){if(n){return at>bt?1:-1;}return at>bt?-1:1;}if(an&&bn){if(so){return av-bv;}else{return bv-av;}}if(!al&&!bl)return -1;if(!al&&bl)return 1;if(al&&!bl)return -1;if(!p){if(so){if(i){if(al===bl){return -1;}else{return al>bl?1:-1;}}else{return av>bv?1:-1;}}else{if(i){if(al===bl){return -1;}return al>bl?-1:1;}else{if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}return av>bv?-1:1;}}}if(p===1){if(so){if(!i){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return av>bv?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?1:-1;}}else{if(al===bl){if(aisu&&!bisu){return 1;}else if(!aisu&&bisu){return -1;}else{return -1;}}else{return al>bl?-1:1;}}}}if(p===2){if(so){if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?1:-1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?1:-1;}}}else{if(!i){if((aisu&&bisu)||(!aisu&&!bisu)){return av>bv?-1:1;}else{return aisu?-1:1;}}else{if(al===bl){if(aisu&&!bisu){return -1;}else if(!aisu&&bisu){return 1;}else{return 0;}}else{return al>bl?-1:1;}}}}});for(j;j<l;j++){m=o[j];c(m.c,j+1,o.length,m.n)}}})",
h="(function(v){try{return v()}catch(e){return typeof(v)==='function'?void(0):v}})",f="(function(l,s){var r=[],a,v,o,t;try{o=l()}catch(e){o=l}if(!!o&&typeof(o)==='object'){for(a in o){try{v=s(o[a]);t=typeof(v);r.push({n:a,c:o[a],l:t==='string'?v.toLowerCase():'',t:t,v:(t==='string'||t==='number')?v:''});}catch(e){r.push({n:a,c:o[a],s:'',v:'',k:''});}}}return r})",k="(function(){var r=[],i=0,t='numberstringboolean',f=function(s){var y,v;try{v=s();}catch(e){v=s;}y=typeof(v);r[i++]=(t.indexOf(y)>-1)?v:''};f.s=function(){return r.join('')};return f})");
this.getXforJSLib=function(){return Xa.getXforJSLib()};this.da=function(){return b};this.ea=function(){return d};this.fa=function(){return c};this.ga=function(){return h};this.O=function(){return f};this.ha=function(){return k}}function F(){var a=[];this.add=function(b){a.push(b);return this};this.toString=function(){return a.join("")}}
function Za(a,b,d,c,h){var f=this,k={},j=[],p=[],s=b||"";"string"!==typeof a&&e("Prefix is required.");"string"!==typeof d&&e("Seperator is required.");"string"!==typeof c&&e("Postfix is required");this.add=function(a,b){var c=s+a;k.hasOwnProperty(c)&&e("The following has been declared twice: "+a);b&&"object"===typeof b||"string"===typeof b||e('Null value was discovered for the following: "'+a+'"');k[c]=b;j.push(c);return f};this.S=function(a){return k.hasOwnProperty(s+a)||h&&h.S(a)?g:l};this.ka=
function(){return s};this.toString=function(){var b,f,h=0;if(0<j.length){b=j.shift();f=k[b].toString();p.push(a+b);""!==f&&p.push(d+f);for(b=j.length;h<b;h++)f=j[h],p.push(","+f),f=k[f],f.toString()&&p.push(d+f);p.push(c)}return p.join("")}}function $a(){var a=[],b=[],d={};this.put=function(c,h){!d.hasOwnProperty(c)&&(c&&h)&&(a.push(c),b.push(h),d[c]=g);return this};this.ja=function(){return a.join(",")};this.$=function(){return b.join(",")}}
function ab(a){this.toString=function(){return a.ja()}}function bb(a){this.toString=function(){return a.$()}}
function cb(a){var b="string"===typeof a&&a||"",d=1,c=1;this.length=function(){return b.length};this.charAt=function(a){a=a||0;a>=b.length&&e("There are no more characters to parse.");return b[a]};this.shift=function(a){var f=0,k;if(-1<b.length-~~a){for(f=0;f<a;f++)switch(k=b[f],k){case "\r":"\n"===b[f+1]&&f++;case "\n":d++;c=1;continue;default:c++}b=b.slice(a)}else e("Can't shift.  Nothing left to parse.");return this};this.match=function(a){return a.exec(b)};this.c=function(){var a=ga.exec(b);return a?
(this.shift(a[1].length),g):l};this.na=function(){return 0===b.indexOf("{:else}")};this.ia=function(){return d};this.ba=function(){return c}}function G(){}G.prototype.execute=m();G.prototype.N=function(){e("Block continuations are not allowed here.")};G.prototype.close=function(){e('Unable to close: "'+this.constructor.name+'"')};G.prototype.name="Production";
function db(a,b,d){a instanceof F||e("output must be of type Output.");b instanceof eb||e("compiler must be of type Compiler.");d&&!(d instanceof db)&&e("previousContext must be of type ProductionContext.");var c=new Za("var ","__","=",";",void 0),h=[c],f,k=[],j,p,s;d?(this.u=d.u,this.e=d.e,this.s=d.s,this.r=d.r,this.w=d.w,this.k=d.k,this.d=d.d,s=d.aa()):(this.u={},this.e=new $a,this.s=new ab(this.e),this.r=new bb(this.e),this.w={},this.k=b.X,this.d=b.d,s=new fb);var v=this.k,t=[v];this.Aa=function(a){var b;
if(a&&"object"===typeof a){for(b in v)a.hasOwnProperty(b)||(a[b]=v[b]);t.push(a);this.k=v=a}else e("obj must be an object.");return this};this.i=function(a){return v[a]};this.za=function(){1<t.length?(t.pop(),this.k=v=t[t.length-1]):e("Can't remove default configuration.");return this};this.va=function(){return this.e};this.ua=function(){return this.s};this.pa=function(){return this.r};this.U=function(a){a||e("invalid namespace given.");j||(j=a);this.u[a]=g};this.P=function(){j||e("no namespace has been declared.");
return j||""};this.ya=function(a){return this.u[a]};this.ma=function(a){p&&e("can't set path more than once.");p=Ma(a)};this.la=function(a){p||e("Can't import '"+a+"' because no inputFilePath was given to the ProductionContext.");var c=require("path"),d=require("fs"),f=c.dirname(p);a=Ma(c.resolve(f,a));if(this.w[a])return"";this.w[a]=g;d=d.readFileSync(a,"utf8");return b.compile(d,a,this)};this.a=function(a){k.push(a);f=a};this.b=function(){k.length||e("There is no production to remove from context.");
k.pop();f=k[k.length-1];return this};this.Z=function(a){f.execute(a,this)};this.Y=function(a){f.N(a,this)};this.ca=function(){return f};this.h=function(){return c};this.M=function(){var a=new Za("var ","__","=",";",c);c=a;h.push(a)};this.T=function(){var a=h.length;1<a?(h.pop(),c=h[a-2]):e("Illegal attempt to remove VariableOutput.")};this.J=function(a){c.S(a)||e('Variable "'+a+"\" hasn't been declared yet.")};this.aa=function(){return s};this.I=function(a){s.I(a);return this};this.z=function(a){s.z(a);
return this};this.Q=function(a){return s.Q(a)};this.R=function(a){return s.R(a)};this.close=function(){var a=k.length,b=a-1;if(a)for(;-1<b;b--)k[b].close(this);else e("No productions were found.");s.oa()}}function H(){}r(H,G);H.prototype.name="AbstractAssignment";H.prototype.execute=function(a,b){this.l?b.b():(this.l=g,b.a(this.getExpression()))};H.prototype.getExpression=m();function I(){}r(I,G);q=I.prototype;q.name="AbstractConditionBlock";q.K=l;q.L=g;q.v=g;q.A=m();q.B=m();q.H=m();
q.execute=function(a,b){var d;if(this.L)b.a(this.H()),this.L=l;else{a.c();switch(a.charAt(0)){case "/":if(this.v&&this.K&&"}"===a.charAt(1)){a.shift(2);b.b();return}e("Unexpected '/'");case "}":if(this.v){a.shift(1);this.v=l;b.a(this.A());return}break;case "{":if(!this.v&&"/"===a.charAt(1)&&(d=a.match(this.B()))){a.shift(d[1].length);b.b();return}}e("Invalid Expression found.")}};function J(){}r(J,G);q=J.prototype;q.name="AbstractExpression";q.m=l;q.g=l;q.V=/^([!~]+)/;q.W=/^(typeof)(?=[\(\s])/;
q.execute=function(a,b){var d=this.f();a.c();if("}"!==a.charAt(0)){if(this.g===l||this.m){this.m=l;this.g=g;var c;switch(a.charAt(0)){case "!":case "~":c=a.match(this.V);c=c[1];a.shift(c.length);a.c();d.add(c);break;case "t":if(c=a.match(this.W))a.shift(c[1].length),d.add("typeof"),a.c(),"("!==a.charAt(0)&&d.add(" ")}"("===a.charAt(0)?(a.shift(1),c=new F,d.add(c),b.a(this.F(c))):b.a(this.G());return}if(this.g)switch(a.charAt(0)){case "]":case ")":break;default:this.m=g;this.g=l;b.a(new gb(d));return}}this.g&&
!this.m?b.b():(this.m&&e("Unclosed Operator."),e("Empty Expression."))};q.G=m();q.F=m();q.f=m();function K(){}r(K,G);q=K.prototype;q.name="AbstractVariableDeclaration";
q.execute=function(a,b){a.c();if(!this.g){this.g=g;var d=a.match(this.p());if(d)if(a.shift(d[1].length),a.c(),d=a.match(u)){d=d[1];a.shift(d.length);if(a.c()){var c=new F;this.n(d,c);this.j().add(d,c);b.a(this.q(c));return}this.o(d,b)}else e("No valid name was found.");else e("Invalid start tag.")}this.g&&"}"===a.charAt(0)?(a.shift(1),b.b()):e("Invalid character found.")};q.p=m();q.j=m();q.q=m();q.n=m();q.o=m();
function L(){this.execute=function(a,b){a.c();"{"===a.charAt(0)&&a.charAt(1)===this.t&&a.match(this.D())?b.a(this.C()):b.b()}}r(L,G);L.prototype.name="AbstractVariableDeclarations";L.prototype.t="";L.prototype.C=m();L.prototype.D=m();
function M(){this.execute=function(a,b){a.c();switch(a.charAt(0)){case ")":this.l||e("Empty Expressions are not allowed.");a.shift(1);b.b();return;default:if(!this.l){this.l=g;var d=new F;this.f().add("(").add(d).add(")");b.a(this.getExpression(d));return}}e("Possibly an unclosed paren was found.")}}r(M,G);M.prototype.l=l;M.prototype.getExpression=m();M.prototype.f=m();
function gb(a){this.execute=function(b,d){var c="";b.c();switch(b.charAt(0)){case "=":if("="===b.charAt(1)){"="===b.charAt(2)?(b.shift(3),c="==="):(b.shift(2),c="==");a.add(c);d.b();return}break;case "!":if("="===b.charAt(1)){"="===b.charAt(2)?(b.shift(3),c="!=="):c="!=";a.add(c);d.b();return}break;case "|":if("|"===b.charAt(1)){b.shift(2);a.add("||");d.b();return}break;case "&":if("&"===b.charAt(1)){b.shift(2);a.add("&&");d.b();return}break;case "<":case ">":if("="===b.charAt(1)){a.add(b.charAt(0)+
"=");b.shift(2);d.b();return}case "+":case "-":case "%":case "*":case "/":a.add(b.charAt(0));b.shift(1);d.b();return}e("Invalid Operator.")}}r(gb,G);gb.prototype.name="Operator";
function hb(a,b,d){var c=new F,h=new F,f=new F,k=b.e,j=b.s,p=b.h(),s=l,v=l;a.add("(function(").add(j).add("){").add(c).add(h).add("(function(").add(j).add("){").add(p).add(f).add("})(").add(j).add(");");d?a.add("})(").add(j).add(");"):(b.i("global")||a.add("return "+D),b.i("escapexss")&&k.put(Ta,b.d.ea()),a.add("})(").add(b.r).add(");"),k.put(Wa,b.d.ha()).put(D,b.i("global")?"(function(){return this})()":"{}").put(Va,b.d.ga()));this.execute=function(a,b){var d;a.c()&&!s&&e("Space isn't allowed before a namespace.");
if(0!==a.length()){if("{"===a.charAt(0))if(s){if("{"===a.charAt(0))switch(a.charAt(1)){case "i":v&&e("ImportStatements must appear before GlobalVariableStatements and GlobalStatements.");d=new F;h.add(d);b.a(new ib(d));return;case "v":v&&e("GlobalVariableDeclarations must appear before GlobalStatements.");v=g;b.a(new jb);return;case "t":v=g;b.a(new kb(f));return}}else{"n"!==a.charAt(1)&&e("The first Production must be a ProgramNamespace.");s=g;b.a(new lb(c));return}e("Unknown characters: "+a.charAt(0)+
a.charAt(1))}};this.close=function(){s||e("No ProgramNamespace was declared.");v||e("Global Statements must appear before exiting Program.")}}r(hb,G);hb.prototype.name="Program";
function lb(a){this.execute=function(b,d){var c;if("{"===b.charAt(0))if(c=b.match(ua)){if(b.shift(c[1].length),c=b.match(ca)){c=c[1];b.shift(c.length);La(c);d.U(c);c=c.split(".");var h="",f;a.add("var "+B+"="+D+";");var k=c.length,j;for(j=0;j<k;j++)h=c[j],f=f?f+("."+h):h,d.U(f),a.add(B+"="+B+"."+h+"||("+B+"."+h+"={});");if("}"===b.charAt(0)){b.shift(1);d.b();return}e("Invalid character found after namespace value.")}}else e("NameSpace wasn't valid.");e("Unknown Character: '"+b.charAt(0))}}r(lb,G);
lb.prototype.name="ProgramNamespace";function ib(a){this.execute=function(b,d){b.c();"{"===b.charAt(0)&&"i"===b.charAt(1)?d.a(new mb(a)):d.b()}}r(ib,G);ib.prototype.name="ImportStatements";function mb(a){this.execute=function(b,d){var c=b.match(sa);if(c)if(b.shift(c[1].length),c=b.match(aa)){if(c=c[1],b.shift(c.length).c(),"}"===b.charAt(0)){b.shift(1);a.add(d.la(c));d.b();return}}else e("Invalid import path given");e("No statement found.")}}r(mb,G);mb.prototype.name="ImportStatement";
function jb(){this.execute=function(a,b){a.c();"{"===a.charAt(0)&&"v"===a.charAt(1)?b.a(new N(b.h())):b.b()}}r(jb,G);jb.prototype.name="GlobalVariableDeclarations";function N(a){this.j=function(){return a};this.o=function(b){a.add(b,"")}}r(N,K);N.prototype.name="GlobalVariableDeclaration";N.prototype.p=function(){return y};N.prototype.q=function(a){return new nb(a)};N.prototype.n=m();function nb(a){this.getExpression=function(){return new O(a)}}r(nb,H);nb.prototype.name="GlobalVariableAssignment";
function P(a){this.execute=function(b,d){b.c();var c;switch(b.charAt(0)){case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":c=Ha;break;case "@":b.shift(1);var h=b.match(u);if(h){c=h[1];d.J(c);b.shift(c.length);a.add("__"+c);d.b();return}break;case "'":case '"':c=Ja;break;case "n":c=Ia;break;case "t":case "f":c=Ga}if(c&&(c=b.match(c))){c=c[1];b.shift(c.length);a.add(c);d.b();return}e("Invalid value.")}}r(P,G);P.prototype.name="GlobalVariableValue";
function O(a){this.f=function(){return a};this.G=function(){return new P(a)};this.F=function(a){return new ob(a)}}r(O,J);O.prototype.name="GlobalExpression";function ob(a){this.getExpression=function(a){return new O(a)};this.f=function(){return a}}r(ob,M);ob.prototype.name="GlobalParenthesizedExpression";
function kb(a){var b=l;this.execute=function(d,c){d.c();if(d.length())if("{"===d.charAt(0)){b=g;var h=new F;a.add(h);c.a(new pb(h))}else e("Invalid character found.");else c.b()};this.close=function(){b||e("No GlobalStatements were found.")}}r(kb,G);kb.prototype.name="GlobalStatements";
function pb(a){var b=l,d=l,c=l,h=new F;this.execute=function(f,k){var j;f.c();if("{"===f.charAt(0))if(b){if(c&&"v"===f.charAt(1)){k.a(new Q(k.h()));c=l;d=g;return}if("/"===f.charAt(1)){if(j=f.match(xa)){f.shift(j[1].length);k.b();k.T();return}e("Template Declarations must be followed by '{/template}.")}if(d){d=l;k.a(new R(h));return}}else{b=g;k.M();if(j=f.match(wa)){f.shift(j[1].length);if(j=f.match(u)){j=j[1];f.shift(j.length);k.I(k.P()+"."+j);a.add(B+"."+j+"=function("+Na+", "+Qa+"){var "+A+"="+
Na+"||{},"+Pa+"="+Qa+"||{},"+z+"="+Wa+"(),"+C+"=''/0,"+Oa+"='',"+Ra+"="+C+";").add(k.h()).add(h).add("return "+z+".s()");a.add("};");if("}"===f.charAt(0)){f.shift(1);k.a(new S(k.h()));d=c=g;return}e("A closing curly must immediately follow a template name.")}e("Templates must have a name")}e("Only Templates are allowed in this context.")}else if(d){d=l;k.a(new R(h));return}e("Invalid character?")}}r(pb,G);pb.prototype.name="TemplateDeclaration";
function R(a){this.execute=function(b,d){"{"===b.charAt(0)&&"/"===b.charAt(1)?d.b():d.a(new T(a))}}r(R,G);R.prototype.name="TemplateBody";
function T(a){this.execute=function(b,d){var c;(c=b.match(ia))&&b.shift(c[1].length);if("{"===b.charAt(0)){switch(b.charAt(1)){case ":":d.b().Y(b);return;case "/":d.b();return;case "v":(c=b.match(y))&&e("VariableDeclarations are not allowed in this context.");break;case "p":(c=b.match(x))&&e("ParamDeclarations are not allowed in this context.");break;case "i":if(c=b.match(qa)){b.shift(c[1].length);c=new F;d.a(new U(c));a.add(c);return}break;case "l":if(c=b.match(ta)){b.shift(c[1].length);c=new F;
d.a(new qb(c,d));a.add(c);return}break;case "c":if(c=b.match(ma)){b.shift(c[1].length);c=new F;d.a(new rb(c));a.add(c);return}break;case "f":if(c=b.match(oa)){b.shift(c[1].length);c=new F;d.a(new sb(c,d));a.add(c);return}break;case "t":if(c=b.match(ya)){b.shift(c[1].length);c=new F;d.a(new tb(c));a.add(c);return}}c=new F;a.add(c);d.a(new ub(c))}else c=new F,a.add(c),d.a(new vb(c))}}r(T,G);T.prototype.name="TemplateBodyStatements";function S(a){this.C=function(){return new V(a)}}r(S,L);
S.prototype.name="ParamDeclarations";S.prototype.t="p";S.prototype.D=function(){return x};function V(a){this.j=function(){return a};this.o=function(b){a.add(b,Pa+"."+b)}}r(V,K);V.prototype.p=function(){return x};V.prototype.q=function(a){return new W(a)};V.prototype.n=function(a,b){b.add(Pa+"."+a+"||")};function Q(a){this.C=function(){return new X(a)}}r(Q,L);Q.prototype.name="VariableDeclarations";Q.prototype.t="v";Q.prototype.D=function(){return y};
function X(a){this.j=function(){return a};this.o=function(b){a.add(b,"")}}r(X,K);X.prototype.name="VariableDeclaration";X.prototype.p=function(){return y};X.prototype.q=function(a){return new W(a)};X.prototype.n=m();function W(a){this.getExpression=function(){return new Y(a)}}r(W,H);W.prototype.name="AbstractAssignment";function Y(a){this.f=function(){return a};this.G=function(){return new wb(a,l)}}r(Y,J);Y.prototype.name="VariableExpression";Y.prototype.F=function(a){return new xb(a)};
function xb(a){this.getExpression=function(a){return new Y(a)};this.f=function(){return a}}r(xb,M);xb.prototype.name="VariableParenthesizedExpression";
function wb(a,b){function d(b,c){h||(h=new P(a));h.execute(b,c)}var c=l,h;this.execute=function(f,h){var j;f.c();if(c){if(")"===f.charAt(0)){f.shift(1);a.add(")");h.b();return}e("Expecting close paren.")}switch(f.charAt(0)){case ")":e("Unexpected close paren.");case "@":if(j=f.match(ka)){h.J(j[1]);break}case "'":case '"':case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":d(f,h);return;case "p":if(j=f.match(Fa)){f.shift(j[1].length);a.add(Ra);h.b();return}break;
case "c":if(j=f.match(Ba)){c=g;var p=new F;f.shift(j[1].length);a.add(Sa).add("(").add(p);h.a(new Z(p,b));h.e.put(Sa,h.d.da());return}break;case "l":if(j=f.match(Da)){f.shift(j[1].length);a.add(C);h.b();return}break;case "n":if(j=f.match(Ia)){d(f,h);return}if(j=f.match(Ea)){f.shift(j[1].length);a.add(Oa);h.b();return}break;case "t":case "f":if(j=f.match(Ga)){d(f,h);return}}h.b();h.a(new Z(a,b))}}r(wb,G);wb.prototype.name="VariableValue";
function Z(a,b){var d,c=l,h=g,f=g,k=g,j=g,p=l;b?d=a:(d=new F,a.add(Va+"(function(){return ").add(d).add("})"));this.execute=function(a,b){var t,w;if(!p){a.c();w=a.charAt(0);switch(w){case "@":(t=a.match(la))?(a.shift(t[1].length),b.J(t[2]),d.add(b.h().ka()+t[2]),f=l):e("invalid variable reference.");c=g;break;case "c":if(t=a.match(Ca))a.shift(t[1].length),f=l;c=g;break;case ".":a.shift(1),k=l,c=g}"@"!==w&&d.add(A);p=g}a.c();switch(a.charAt(0)){case ".":k||e("Unexpected '.'.");f=g;c=j=k=h=l;a.shift(1);
d.add(".");break;case "[":j||e("Unexpected '['.");f=l;c=k=j=g;b.a(new yb(d));return}a.c();(w=a.match(ca))?(w=w[1],La(w),a.shift(w.length),h&&d.add("."),d.add(w),w=g):w=l;h=g;w?(f||e("unexpected name."),f=l,c=g):(c||e("Unexpected character."),b.b())}}r(Z,G);Z.prototype.name="ContextSelector";
function yb(a){var b=l;this.execute=function(d,c){var h;d.c();switch(d.charAt(0)){case "[":if(!b){b=g;d.shift(1);h=new F;a.add("[").add(h);c.a(new zb(h,g));return}break;case "]":if(b){b=l;d.shift(1);a.add("]");c.b();return}}e("Unexpected character: '"+d.charAt(0)+"'.")}}r(yb,G);yb.prototype.name="ContextDynamicRefinement";function zb(a,b){this.f=function(){return a};this.G=function(){return new wb(a,b)};this.F=function(a){return new Ab(a)}}r(zb,J);zb.prototype.name="ContextExpression";
function Ab(a){this.getExpression=function(a){return new zb(a,g)};this.f=function(){return a}}r(Ab,M);Ab.prototype.name="ContextParenthesizedExpression";function vb(a){this.execute=function(b,d){var c=b.match(ba);c?(c=c[1],b.shift(c.length),d.i("normalizespace")&&(c=c.replace(/\s+/g," ")),d.i("minifyhtml")&&(c=c.replace(ha,"$1$2")),c=c.replace(/\\{/g,"{").replace(/\\#/g,"#").replace(/\n|\r/g,"\\\n"),a.add(z+"('"+c+"');"),d.b()):e("Invalid Character found.")}}r(vb,G);vb.prototype.name="InputTokens";
function ub(a){var b=l;this.execute=function(d,c){var h;switch(d.charAt(0)){case "{":if(!b){b=g;h=new F;d.shift(1);a.add(z+"(");c.i("escapexss")?a.add(Ta+"(").add(h).add(")"):a.add(h);a.add(");");c.a(new Y(h));return}break;case "}":if(b){d.shift(1);c.b();return}}e("Invalid Character.")}}r(ub,G);ub.prototype.name="PrintStatement";
function U(a){var b=new F,d=g,c=new F;a.add("if(").add(b).add("){").add(c).add("}");this.H=function(){return new Y(b)};this.A=function(){return new T(c)};this.N=function(b,c){var k,j=new F;d||e("Continuations are not allowed after {:else}");b.na()?(d=l,b.shift(7),a.add("else{").add(j).add("}"),c.a(new T(j))):(k=b.match(Aa))?(b.shift(k[1].length),a.add("else ").add(j),c.b().a(new U(j))):e("Unknown continuation.")}}r(U,I);U.prototype.name="IfStatement";U.prototype.B=function(){return ra};
function qb(a,b){var d=new F,c=l;b.i("removelogs")||a.add("console.log(").add(d).add(");");this.execute=function(a,b){a.c();c?"}"===a.charAt(0)?(a.shift(1),b.b()):e("Invalid character."):(c=g,b.a(new Y(d)))}}r(qb,G);qb.prototype.name="LogStatement";function rb(a){var b=new F,d=new F,c=new F;this.K=g;a.add(z).add("(").add(b).add("(").add(d).add(c).add(")").add(");");this.H=function(){return new Bb(b,d)};this.A=function(){return new $(c)}}r(rb,I);rb.prototype.B=function(){return na};
rb.prototype.name="CallStatement";function $(a){var b=new Za(",{","",":","}",null),d=g;this.j=function(){return b};this.C=function(){d&&(d=l,a.add(b));return new Cb(b)}}r($,L);$.prototype.name="CallParams";$.prototype.t="p";$.prototype.D=function(){return x};function Cb(a){this.j=function(){return a}}r(Cb,K);q=Cb.prototype;q.name="CallParamDeclaration";q.p=function(){return x};q.q=function(a){return new W(a)};q.n=m();q.o=function(){e("An assignment must be made here.")};
function Bb(a,b){var d=l;this.execute=function(c,h){var f;if(!d){if(f=c.match(da))d=g,f=f[1],c.shift(f.length),a.add(D+"."+f),h.z(f);else if(f=c.match(u))d=g,f=f[1],c.shift(f.length),a.add(B+"."+f),h.z(h.P()+"."+f);if(d){h.b();c.c();f=c.charAt(0);"/"!==f&&"}"!==f?h.a(new Z(b,l)):b.add(A);return}e("A valid Namespace must be given.")}e("Invalid Character")}}r(Bb,G);Bb.prototype.name="CallExpression";
function tb(a){this.execute=function(b,d){var c;if(c=b.match(ja))c=c[1],b.shift(c.length),a.add(z+"('"+c.replace("\\","\\\\").replace(/\r?\n/g,"\\\n").replace("'","\\'")+"');");(c=b.match(za))?(b.shift(c[1].length),d.b()):e("Unexpected character.")}}r(tb,G);tb.prototype.name="TextStatement";
function sb(a,b){var d=new F,c=new F,h=new F,f=new F;a.add(Ua+"(").add(E+"(").add(d).add(f).add(")").add(",").add("function("+A+","+Ra+","+C+","+Oa+"){").add(c).add("}").add(h).add(");");b.e.put(Ua,b.d.fa()).put(E,b.d.O());this.H=function(){return new Z(d,l)};this.A=function(){return new Db(c,f,h)}}r(sb,I);sb.prototype.name="ForeachStatement";sb.prototype.B=function(){return pa};
function Db(a,b,d){var c=l,h=l,f=l,k=l;this.execute=function(j,p){var s;j.c();k||(k=g,p.M());switch(j.charAt(0)){case "{":switch(j.charAt(1)){case "s":if(!c&&(!h&&!f)&&(c=g,s=j.match(va))){j.shift(s[1].length);p.a(new Eb(b,d,p));return}break;case "v":if(!h&&!f&&(h=g,s=j.match(y))){a.add(p.h());p.a(new Q(p.h()));return}break;case "/":p.b();p.T();return}default:f=g,p.a(new T(a))}}}r(Db,G);Db.prototype.name="ForeachBodyStatements";
function Eb(a,b,d){d.e.put(E,d.d.O());var c=l,h=l;this.execute=function(d,k){d.c();if(c){if(!h){var j=d.match(ea);if(j){h=g;j=j[1];d.shift(j.length);var j=0===j.indexOf("|asc"),p=l,s=0,v=0,t=d.match(fa);t&&(t=t[1],d.shift(t.length),-1<t.indexOf("i")&&(v=1,/i[^i]*?i/i.test(t)&&e("'i' may only appear once in sort options.")),(p=-1<t.indexOf("n"))&&/n[^n]*?n/i.test(t)&&e("'n' may only appear once in sort options."),-1<t.indexOf("c")?s=1:-1<t.indexOf("C")&&(s=2),s&&/c[^c]*?c/i.test(t)&&e("Only one of 'c' or 'C' may appear in sort options."));
b.add(","+(j?1:0)+","+(p?1:0)+","+s+","+v)}else e("Sort direction must be one of '|asc' or '|desc'.")}h||e("One of '|asc' or '|desc' is required.");"}"===d.charAt(0)?(d.shift(1),k.b()):e("Invalid Character.")}else c=g,j=new F,a.add(",function("+A+"){return ").add(j).add("}"),k.a(new Z(j,g))}}r(Eb,G);Eb.prototype.name="SortStatement";
function fb(){var a={},b={};this.I=function(b){a[b]=g;return this};this.z=function(a){b[a]=g;return this};this.Q=function(a){return b.hasOwnProperty(a)};this.R=function(b){return a.hasOwnProperty(b)};this.oa=function(){for(var d in b)a.hasOwnProperty(d)||e(d+" has not been declared.")}}
function eb(a){a=a||{};var b={debug:l,escapexss:g,global:g,minifyhtml:g,normalizespace:g,outputlibrary:"",removelogs:g,useexternal:l,warn:l},d;for(d in a)d in b&&(b[d]=a[d]);this.X=b;this.d=new Ya(b);this.getXforJSLib=function(){return this.d.getXforJSLib()};this.compile=function(a,b,d){(!a||"string"!==typeof a)&&e("input must be a string.");var k=new F;a=new cb(a);var j=new db(k,this,d);b&&j.ma(b);try{for(j.a(new hb(k,j,!!d));0<a.length();)j.Z(a);j.close()}catch(p){e("=========================\n"+
j.ca().name+":\n-------------------------\n"+p+"\n\n   Line       : "+a.ia()+"\n   Column     : "+a.ba()+"\n=========================\n")}return k.toString()}}this.XforJS={server:g,getCompiler:function(a){return new eb(a)}};}();
