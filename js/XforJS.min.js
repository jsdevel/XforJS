!function(){function f(a){throw a;}var h=!0,l=!1;function m(){return function(){}}var n;function r(a,b){a.prototype=new b;a.prototype.constructor=a}
var aa=/^((?:[^\}\\]|\\[\}\\])+\.xjs)/,ba=/^((?:[^#'\{\\]|\\(?:#|'|\\|\{))+)/,s=/^([a-zA-Z$_](?:[\w$]+)?)/,ca=/^([a-zA-Z$_](?:[\w$]+)?(?:(?:\.[a-zA-Z$_](?:[\w$]+)?)+)?)/,da=/^([a-zA-Z$_](?:[\w$]+)?(?:\.[a-zA-Z$_](?:[\w$]+)?)+)/,ea=/^(asc|desc)(?![\w$])/,fa=/^(\|(?:in|ni|n|i))(?![\w$])/,ga=/^((?:\s|#[^\r\n]+(?:\r?\n)?)+)/,ha=/(>|<)\s+|\s+(>|<)/g,ia=/^((?:\s|#[^\r\n]+(?:\r?\n)?)+)(?=\{)/,ja=/^((?:(?!\{\/text\})[\s\S])+)(?=\{\/text\})/,ka=/^@([a-zA-Z$_](?:[\w$]+)?)\s*[\.\[]/,la=/^(@([a-zA-Z$_](?:[\w$]+)?))/,
ma=/^(\{call\s+)/,na=/^(\{\/call\})/,oa=/^(\{foreach\s+)/,pa=/^(\{\/foreach\})/,qa=/^(\{if\s+)/,ra=/^(\{\/if\})/,sa=/^(\{import\s+)/,ta=/^(\{log\s+)/,ua=/^(\{namespace\s+)/,u=/^(\{param\s+)/,va=/^(\{sort\s+)/,wa=/^(\{template\s+)/,xa=/^(\{\/template\})/,ya=/^(\{text\})/,za=/^(\{\/text\})/,w=/^(\{var\s+)/,Aa=/^(\{:elif\s+)/,Ba=/^(count\()/,Ca=/^(current\(\))/,Da=/^(last\(\))/,Ea=/^(name\(\))/,Fa=/^(position\(\))/,Ga=/^(false|true)(?![\w$])/,Ha=/^((?:0x(?=([0-9A-Fa-f]+))\2(?!\.)|(?=(0(?![0-9])|[1-9][0-9]*))\3(?!x)(?:\.[0-9]+)?)(?:[eE][-+][0-9]+)?)/,
Ia=/^(null)(?![\w$])/,Ja=/^((['"])(?=((?:(?:(?!\2|\r?\n|\\)[\s\S]|\\(?:\\|\2|\r?\n))+)?))\3\2)/,Ka={"break":h,"case":h,"catch":h,"continue":h,"debugger":h,"default":h,"delete":h,"do":h,"else":h,"finally":h,"for":h,"function":h,"if":h,"in":h,"instanceof":h,"new":h,"return":h,"switch":h,"this":h,"throw":h,"try":h,"typeof":h,"var":h,"void":h,"while":h,"with":h,"class":h,"const":h,"enum":h,"export":h,"extends":h,"import":h,"super":h,"implements":h,"interface":h,let:h,"package":h,"private":h,"protected":h,
"public":h,"static":h,yield:h};function La(a){a=a.split(".");for(var b=0,d=a.length;b<d;b++)Ka[a[b]]&&f("Usage of the following ECMAScript reserved word is not allowed: "+a[b])}function Ma(a){var b=require("fs"),d=require("path");(!a||"string"!==typeof a)&&f("inputFilePath must be a string.");a=d.normalize(a.replace(/^\s+|\s+$/g,""));/\.xjs$/.test(a)||f("inputFilePath must end with '.xjs'.");b.ra(a)||f("The following path doesn't exist: \n   "+a);return d.ma(a)}
var x="b",y="x",z="N",Na="A",A="L",Oa="n",Pa="P",Qa="M",Ra="O",B="B",Sa="C",Ta="X",Ua="F",C="G",Va="V",Wa="S";
function Xa(a){var b,d,c,g,e,k;(!a||"object"!==typeof a)&&f("args must be an object.");a.Aa?(b="xforj."+Sa,d="xforj."+Ta,c="xforj."+Ua,g="xforj."+Va,e="xforj."+C,k="xforj."+Wa):(b="(function(f){var o,c=0,n;try{o=f()}catch(e){o=f}if(!!o&&typeof(o)==='object'){if(o.slice&&o.join&&o.pop){return o.length>>>0;}else{for(n in o){c++;}}}return c})",d="(function(q,p,l,g,a,t){q.exec('a');p.exec('a');l.exec('a');g.exec('a');a.exec('a');t.exec('a');return function(s){if(typeof(s)==='string'){return s.replace(a,'&amp;').replace(q,'&#34;').replace(p,'&#39;').replace(t,'&#96;').replace(l,'&lt;').replace(g,'&gt;');}return s;}})(/\"/g,/'/g,/</g,/>/g,/&(?![a-zA-Z]+;|#[0-9]+;)/g,/`/g)",c=
"(function(o,c,so,n){var i=0,l,m;if(!!o&&typeof(o)==='object'&&typeof(c)==='function'){l=o.length;if(so!==void(0))o.sort(function(c,d){var a=c.k,b=d.k,at=typeof(a),bt=typeof(b);if(a===b)return 0;if(at===bt)return (!!so?a<b:a>b)?-1:1;return (!!n?at<bt:at>bt)?-1:1});for(;i<l;i++){m=o[i];c(m.c,i+1,o.length,m.n)}}})",g="(function(v){try{return v()}catch(e){return typeof(v)==='function'?void(0):v}})",e="(function(l,s,i){var r=[],a,v,o;try{o=l()}catch(e){o=l}if(!!o&&typeof(o)==='object'){for(a in o){try{v=s(o[a]);r.push({n:a,c:o[a],k:typeof(v)==='string'&&i?v.toLowerCase():v});}catch(e){r.push({n:a,c:o[a],k:''});}}}return r})",
k="(function(){var r=[],i=0,t='numberstringboolean',f=function(s){var y,v;try{v=s();}catch(e){v=s;}y=typeof(v);r[i++]=(t.indexOf(y)>-1)?v:''};f.s=function(){return r.join('')};return f})");this.va=function(){return"/* \n * Copyright 2012 Joseph Spencer.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nxforj={\n   C:(function(f){var o,c=0,n;try{o=f()}catch(e){o=f}if(!!o&&typeof(o)==='object'){if(o.slice&&o.join&&o.pop){return o.length>>>0;}else{for(n in o){c++;}}}return c}),\n   X:(function(q,p,l,g,a,t){q.exec('a');p.exec('a');l.exec('a');g.exec('a');a.exec('a');t.exec('a');return function(s){if(typeof(s)==='string'){return s.replace(a,'&amp;').replace(q,'&#34;').replace(p,'&#39;').replace(t,'&#96;').replace(l,'&lt;').replace(g,'&gt;');}return s;}})(/\"/g,/'/g,/</g,/>/g,/&(?![a-zA-Z]+;|#[0-9]+;)/g,/`/g),\n   F:(function(o,c,so,n){var i=0,l,m;if(!!o&&typeof(o)==='object'&&typeof(c)==='function'){l=o.length;if(so!==void(0))o.sort(function(c,d){var a=c.k,b=d.k,at=typeof(a),bt=typeof(b);if(a===b)return 0;if(at===bt)return (!!so?a<b:a>b)?-1:1;return (!!n?at<bt:at>bt)?-1:1});for(;i<l;i++){m=o[i];c(m.c,i+1,o.length,m.n)}}}),\n   V:(function(v){try{return v()}catch(e){return typeof(v)==='function'?void(0):v}}),\n   G:(function(l,s,i){var r=[],a,v,o;try{o=l()}catch(e){o=l}if(!!o&&typeof(o)==='object'){for(a in o){try{v=s(o[a]);r.push({n:a,c:o[a],k:typeof(v)==='string'&&i?v.toLowerCase():v});}catch(e){r.push({n:a,c:o[a],k:''});}}}return r}),\n   S:(function(){var r=[],i=0,t='numberstringboolean',f=function(s){var y,v;try{v=s();}catch(e){v=s;}y=typeof(v);r[i++]=(t.indexOf(y)>-1)?v:''};f.s=function(){return r.join('')};return f})\n};\n\n"};
this.da=function(){return b};this.ea=function(){return d};this.fa=function(){return c};this.ga=function(){return g};this.O=function(){return e};this.ha=function(){return k}}function D(){var a=[];this.add=function(b){a.push(b);return this};this.toString=function(){return a.join("")}}
function Ya(a,b,d,c,g){var e=this,k={},j=[],p=[],q=b||"";"string"!==typeof a&&f("Prefix is required.");"string"!==typeof d&&f("Seperator is required.");"string"!==typeof c&&f("Postfix is required");this.add=function(a,b){var c=q+a;k.hasOwnProperty(c)&&f("The following has been declared twice: "+a);b&&"object"===typeof b||"string"===typeof b||f('Null value was discovered for the following: "'+a+'"');k[c]=b;j.push(c);return e};this.S=function(a){return k.hasOwnProperty(q+a)||g&&g.S(a)?h:l};this.ka=
function(){return q};this.toString=function(){var b,e,g=0;if(0<j.length){b=j.shift();e=k[b].toString();p.push(a+b);""!==e&&p.push(d+e);for(b=j.length;g<b;g++)e=j[g],p.push(","+e),e=k[e],e.toString()&&p.push(d+e);p.push(c)}return p.join("")}}function Za(){var a=[],b=[],d={};this.put=function(c,g){!d.hasOwnProperty(c)&&(c&&g)&&(a.push(c),b.push(g),d[c]=h);return this};this.ja=function(){return a.join(",")};this.$=function(){return b.join(",")}}
function $a(a){this.toString=function(){return a.ja()}}function ab(a){this.toString=function(){return a.$()}}
function bb(a){var b="string"===typeof a&&a||"",d=1,c=1;this.length=function(){return b.length};this.charAt=function(a){a=a||0;a>=b.length&&f("There are no more characters to parse.");return b[a]};this.shift=function(a){var e=0,k;if(-1<b.length-~~a){for(e=0;e<a;e++)switch(k=b[e],k){case "\r":"\n"===b[e+1]&&e++;case "\n":d++;c=1;continue;default:c++}b=b.slice(a)}else f("Can't shift.  Nothing left to parse.");return this};this.match=function(a){return a.exec(b)};this.c=function(){var a=ga.exec(b);return a?
(this.shift(a[1].length),h):l};this.oa=function(){return 0===b.indexOf("{:else}")};this.ia=function(){return d};this.ba=function(){return c}}function E(){}E.prototype.execute=m();E.prototype.N=function(){f("Block continuations are not allowed here.")};E.prototype.close=function(){f('Unable to close: "'+this.constructor.name+'"')};E.prototype.name="Production";
function cb(a,b,d){a instanceof D||f("output must be of type Output.");b instanceof db||f("compiler must be of type Compiler.");d&&!(d instanceof cb)&&f("previousContext must be of type ProductionContext.");var c=new Ya("var ","__","=",";",void 0),g=[c],e,k=[],j,p,q;d?(this.u=d.u,this.e=d.e,this.s=d.s,this.r=d.r,this.w=d.w,this.k=d.k,this.d=d.d,q=d.aa()):(this.u={},this.e=new Za,this.s=new $a(this.e),this.r=new ab(this.e),this.w={},this.k=b.X,this.d=b.d,q=new eb);var t=this.k,v=[t];this.za=function(a){var b;
if(a&&"object"===typeof a){for(b in t)a.hasOwnProperty(b)||(a[b]=t[b]);v.push(a);this.k=t=a}else f("obj must be an object.");return this};this.i=function(a){return t[a]};this.ya=function(){1<v.length?(v.pop(),this.k=t=v[v.length-1]):f("Can't remove default configuration.");return this};this.ua=function(){return this.e};this.ta=function(){return this.s};this.sa=function(){return this.r};this.U=function(a){a||f("invalid namespace given.");j||(j=a);this.u[a]=h};this.P=function(){j||f("no namespace has been declared.");
return j||""};this.wa=function(a){return this.u[a]};this.na=function(a){p&&f("can't set path more than once.");p=Ma(a)};this.la=function(a){p||f("Can't import '"+a+"' because no inputFilePath was given to the ProductionContext.");var c=require("path"),d=require("fs"),e=c.dirname(p);a=Ma(c.ma(e,a));if(this.w[a])return"";this.w[a]=h;d=d.xa(a,"utf8");return b.compile(d,a,this)};this.a=function(a){k.push(a);e=a};this.b=function(){k.length||f("There is no production to remove from context.");k.pop();e=
k[k.length-1];return this};this.Z=function(a){e.execute(a,this)};this.Y=function(a){e.N(a,this)};this.ca=function(){return e};this.h=function(){return c};this.M=function(){var a=new Ya("var ","__","=",";",c);c=a;g.push(a)};this.T=function(){var a=g.length;1<a?(g.pop(),c=g[a-2]):f("Illegal attempt to remove VariableOutput.")};this.J=function(a){c.S(a)||f('Variable "'+a+"\" hasn't been declared yet.")};this.aa=function(){return q};this.I=function(a){q.I(a);return this};this.z=function(a){q.z(a);return this};
this.Q=function(a){return q.Q(a)};this.R=function(a){return q.R(a)};this.close=function(){var a=k.length,b=a-1;if(a)for(;-1<b;b--)k[b].close(this);else f("No productions were found.");q.pa()}}function F(){}r(F,E);F.prototype.name="AbstractAssignment";F.prototype.execute=function(a,b){this.l?b.b():(this.l=h,b.a(this.getExpression()))};F.prototype.getExpression=m();function G(){}r(G,E);n=G.prototype;n.name="AbstractConditionBlock";n.K=l;n.L=h;n.v=h;n.A=m();n.B=m();n.H=m();
n.execute=function(a,b){var d;if(this.L)b.a(this.H()),this.L=l;else{a.c();switch(a.charAt(0)){case "/":if(this.v&&this.K&&"}"===a.charAt(1)){a.shift(2);b.b();return}f("Unexpected '/'");case "}":if(this.v){a.shift(1);this.v=l;b.a(this.A());return}break;case "{":if(!this.v&&"/"===a.charAt(1)&&(d=a.match(this.B()))){a.shift(d[1].length);b.b();return}}f("Invalid Expression found.")}};function H(){}r(H,E);n=H.prototype;n.name="AbstractExpression";n.m=l;n.g=l;n.V=/^([!~]+)/;n.W=/^(typeof)(?=[\(\s])/;
n.execute=function(a,b){var d=this.f();a.c();if("}"!==a.charAt(0)){if(this.g===l||this.m){this.m=l;this.g=h;var c;switch(a.charAt(0)){case "!":case "~":c=a.match(this.V);c=c[1];a.shift(c.length);a.c();d.add(c);break;case "t":if(c=a.match(this.W))a.shift(c[1].length),d.add("typeof"),a.c(),"("!==a.charAt(0)&&d.add(" ")}"("===a.charAt(0)?(a.shift(1),c=new D,d.add(c),b.a(this.F(c))):b.a(this.G());return}if(this.g)switch(a.charAt(0)){case "]":case ")":break;default:this.m=h;this.g=l;b.a(new fb(d));return}}this.g&&
!this.m?b.b():(this.m&&f("Unclosed Operator."),f("Empty Expression."))};n.G=m();n.F=m();n.f=m();function I(){}r(I,E);n=I.prototype;n.name="AbstractVariableDeclaration";
n.execute=function(a,b){a.c();if(!this.g){this.g=h;var d=a.match(this.p());if(d)if(a.shift(d[1].length),a.c(),d=a.match(s)){d=d[1];a.shift(d.length);if(a.c()){var c=new D;this.n(d,c);this.j().add(d,c);b.a(this.q(c));return}this.o(d,b)}else f("No valid name was found.");else f("Invalid start tag.")}this.g&&"}"===a.charAt(0)?(a.shift(1),b.b()):f("Invalid character found.")};n.p=m();n.j=m();n.q=m();n.n=m();n.o=m();
function J(){this.execute=function(a,b){a.c();"{"===a.charAt(0)&&a.charAt(1)===this.t&&a.match(this.D())?b.a(this.C()):b.b()}}r(J,E);J.prototype.name="AbstractVariableDeclarations";J.prototype.t="";J.prototype.C=m();J.prototype.D=m();
function K(){this.execute=function(a,b){a.c();switch(a.charAt(0)){case ")":this.l||f("Empty Expressions are not allowed.");a.shift(1);b.b();return;default:if(!this.l){this.l=h;var d=new D;this.f().add("(").add(d).add(")");b.a(this.getExpression(d));return}}f("Possibly an unclosed paren was found.")}}r(K,E);K.prototype.l=l;K.prototype.getExpression=m();K.prototype.f=m();
function fb(a){this.execute=function(b,d){var c="";b.c();switch(b.charAt(0)){case "=":if("="===b.charAt(1)){"="===b.charAt(2)?(b.shift(3),c="==="):(b.shift(2),c="==");a.add(c);d.b();return}break;case "!":if("="===b.charAt(1)){"="===b.charAt(2)?(b.shift(3),c="!=="):c="!=";a.add(c);d.b();return}break;case "|":if("|"===b.charAt(1)){b.shift(2);a.add("||");d.b();return}break;case "&":if("&"===b.charAt(1)){b.shift(2);a.add("&&");d.b();return}break;case "<":case ">":if("="===b.charAt(1)){a.add(b.charAt(0)+
"=");b.shift(2);d.b();return}case "+":case "-":case "%":case "*":case "/":a.add(b.charAt(0));b.shift(1);d.b();return}f("Invalid Operator.")}}r(fb,E);fb.prototype.name="Operator";
function gb(a,b,d){var c=new D,g=new D,e=new D,k=b.e,j=b.s,p=b.h(),q=l,t=l;a.add("(function(").add(j).add("){").add(c).add(g).add("(function(").add(j).add("){").add(p).add(e).add("})(").add(j).add(");");d?a.add("})(").add(j).add(");"):(b.i("global")||a.add("return "+B),b.i("escapexss")&&k.put(Ta,b.d.ea()),a.add("})(").add(b.r).add(");"),k.put(Wa,b.d.ha()).put(B,b.i("global")?"(function(){return this})()":"{}").put(Va,b.d.ga()));this.execute=function(a,b){var d;a.c()&&!q&&f("Space isn't allowed before a namespace.");
if("{"===a.charAt(0))if(q){if("{"===a.charAt(0))switch(a.charAt(1)){case "i":t&&f("ImportStatements must appear before GlobalVariableStatements and GlobalStatements.");d=new D;g.add(d);b.a(new hb(d));return;case "v":t&&f("GlobalVariableDeclarations must appear before GlobalStatements.");t=h;b.a(new ib);return;case "t":t=h;b.a(new jb(e));return}}else{"n"!==a.charAt(1)&&f("The first Production must be a ProgramNamespace.");q=h;b.a(new kb(c));return}f("Unknown characters: "+a.charAt(0)+a.charAt(1))};
this.close=function(){q||f("No ProgramNamespace was declared.")}}r(gb,E);gb.prototype.name="Program";
function kb(a){this.execute=function(b,d){var c="";if("{"===b.charAt(0)){var g=b.match(ua);if(g){if(b.shift(g[1].length),g=b.match(ca)){c=g[1];b.shift(c.length);La(c);d.U(c);var c=c.split("."),g="",e;a.add("var "+z+"="+B+";");var k=c.length,j;for(j=0;j<k;j++)g=c[j],e=e?e+("."+g):g,d.U(e),a.add(z+"="+z+"."+g+"||("+z+"."+g+"={});");if("}"===b.charAt(0)){b.shift(1);d.b();return}c="  Invalid character found after namespace value."}}else c="   NameSpace wasn't valid."}this.qa("Invalid Namespace declaration."+
c)}}r(kb,E);kb.prototype.name="ProgramNamespace";function hb(a){this.execute=function(b,d){b.c();"{"===b.charAt(0)&&"i"===b.charAt(1)?d.a(new lb(a)):d.b()}}r(hb,E);hb.prototype.name="ImportStatements";function lb(a){this.execute=function(b,d){var c=b.match(sa);if(c)if(b.shift(c[1].length),c=b.match(aa)){if(c=c[1],b.shift(c.length).c(),"}"===b.charAt(0)){b.shift(1);a.add(d.la(c));d.b();return}}else f("Invalid import path given");f("No statement found.")}}r(lb,E);lb.prototype.name="ImportStatement";
function ib(){this.execute=function(a,b){a.c();"{"===a.charAt(0)&&"v"===a.charAt(1)?b.a(new L(b.h())):b.b()}}r(ib,E);ib.prototype.name="GlobalVariableDeclarations";function L(a){this.j=function(){return a};this.o=function(b){a.add(b,"")}}r(L,I);L.prototype.name="GlobalVariableDeclaration";L.prototype.p=function(){return w};L.prototype.q=function(a){return new mb(a)};L.prototype.n=m();function mb(a){this.getExpression=function(){return new M(a)}}r(mb,F);mb.prototype.name="GlobalVariableAssignment";
function N(a){this.execute=function(b,d){b.c();var c;switch(b.charAt(0)){case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":c=Ha;break;case "@":b.shift(1);var g=b.match(s);if(g){c=g[1];d.J(c);b.shift(c.length);a.add("__"+c);d.b();return}break;case "'":case '"':c=Ja;break;case "n":c=Ia;break;case "t":case "f":c=Ga}if(c&&(c=b.match(c))){c=c[1];b.shift(c.length);a.add(c);d.b();return}f("Invalid value.")}}r(N,E);N.prototype.name="GlobalVariableValue";
function M(a){this.f=function(){return a};this.G=function(){return new N(a)};this.F=function(a){return new nb(a)}}r(M,H);M.prototype.name="GlobalExpression";function nb(a){this.getExpression=function(a){return new M(a)};this.f=function(){return a}}r(nb,K);nb.prototype.name="GlobalParenthesizedExpression";
function jb(a){var b=l;this.execute=function(d,c){d.c();if("{"===d.charAt(0)){b=h;var g=new D;a.add(g);c.a(new ob(g))}else f("Invalid character found.")};this.close=function(){b||f("No GlobalStatements were found.")}}r(jb,E);jb.prototype.name="GlobalStatements";
function ob(a){var b=l,d=l,c=l,g=new D;this.execute=function(e,k){var j;e.c();if("{"===e.charAt(0))if(b){if(c&&"v"===e.charAt(1)){k.a(new O(k.h()));c=l;d=h;return}if("/"===e.charAt(1)){if(j=e.match(xa)){e.shift(j[1].length);k.b();k.T();return}f("Template Declarations must be followed by '{/template}.")}if(d){d=l;k.a(new P(g));return}}else{b=h;k.M();if(j=e.match(wa)){e.shift(j[1].length);if(j=e.match(s)){j=j[1];e.shift(j.length);k.I(k.P()+"."+j);a.add(z+"."+j+"=function("+Na+", "+Qa+"){var "+y+"="+
Na+"||{},"+Pa+"="+Qa+"||{},"+x+"="+Wa+"(),"+A+"=''/0,"+Oa+"='',"+Ra+"="+A+";").add(k.h()).add(g).add("return "+x+".s()");a.add("};");if("}"===e.charAt(0)){e.shift(1);k.a(new Q(k.h()));d=c=h;return}f("A closing curly must immediately follow a template name.")}f("Templates must have a name")}f("Only Templates are allowed in this context.")}else if(d){d=l;k.a(new P(g));return}f("Invalid character?")}}r(ob,E);ob.prototype.name="TemplateDeclaration";
function P(a){this.execute=function(b,d){"{"===b.charAt(0)&&"/"===b.charAt(1)?d.b():d.a(new R(a))}}r(P,E);P.prototype.name="TemplateBody";
function R(a){this.execute=function(b,d){var c;(c=b.match(ia))&&b.shift(c[1].length);if("{"===b.charAt(0)){switch(b.charAt(1)){case ":":d.b().Y(b);return;case "/":d.b();return;case "v":(c=b.match(w))&&f("VariableDeclarations are not allowed in this context.");break;case "p":(c=b.match(u))&&f("ParamDeclarations are not allowed in this context.");break;case "i":if(c=b.match(qa)){b.shift(c[1].length);c=new D;d.a(new S(c));a.add(c);return}break;case "l":if(c=b.match(ta)){b.shift(c[1].length);c=new D;
d.a(new pb(c,d));a.add(c);return}break;case "c":if(c=b.match(ma)){b.shift(c[1].length);c=new D;d.a(new T(c));a.add(c);return}break;case "f":if(c=b.match(oa)){b.shift(c[1].length);c=new D;d.a(new U(c,d));a.add(c);return}break;case "t":if(c=b.match(ya)){b.shift(c[1].length);c=new D;d.a(new qb(c));a.add(c);return}}c=new D;a.add(c);d.a(new rb(c))}else c=new D,a.add(c),d.a(new sb(c))}}r(R,E);R.prototype.name="TemplateBodyStatements";function Q(a){this.C=function(){return new V(a)}}r(Q,J);
Q.prototype.name="ParamDeclarations";Q.prototype.t="p";Q.prototype.D=function(){return u};function V(a){this.j=function(){return a};this.o=function(b){a.add(b,Pa+"."+b)}}r(V,I);V.prototype.p=function(){return u};V.prototype.q=function(a){return new W(a)};V.prototype.n=function(a,b){b.add(Pa+"."+a+"||")};function O(a){this.C=function(){return new X(a)}}r(O,J);O.prototype.name="VariableDeclarations";O.prototype.t="v";O.prototype.D=function(){return w};
function X(a){this.j=function(){return a};this.o=function(b){a.add(b,"")}}r(X,I);X.prototype.name="VariableDeclaration";X.prototype.p=function(){return w};X.prototype.q=function(a){return new W(a)};X.prototype.n=m();function W(a){this.getExpression=function(){return new Y(a)}}r(W,F);W.prototype.name="AbstractAssignment";function Y(a){this.f=function(){return a};this.G=function(){return new tb(a,l)}}r(Y,H);Y.prototype.name="VariableExpression";Y.prototype.F=function(a){return new ub(a)};
function ub(a){this.getExpression=function(a){return new Y(a)};this.f=function(){return a}}r(ub,K);ub.prototype.name="VariableParenthesizedExpression";
function tb(a,b){function d(b,c){g||(g=new N(a));g.execute(b,c)}var c=l,g;this.execute=function(e,g){var j;e.c();if(c){if(")"===e.charAt(0)){e.shift(1);a.add(")");g.b();return}f("Expecting close paren.")}switch(e.charAt(0)){case ")":f("Unexpected close paren.");case "@":if(j=e.match(ka)){g.J(j[1]);break}case "'":case '"':case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":d(e,g);return;case "p":if(j=e.match(Fa)){e.shift(j[1].length);a.add(Ra);g.b();return}break;
case "c":if(j=e.match(Ba)){c=h;var p=new D;e.shift(j[1].length);a.add(Sa).add("(").add(p);g.a(new Z(p,b));g.e.put(Sa,g.d.da());return}break;case "l":if(j=e.match(Da)){e.shift(j[1].length);a.add(A);g.b();return}break;case "n":if(j=e.match(Ia)){d(e,g);return}if(j=e.match(Ea)){e.shift(j[1].length);a.add(Oa);g.b();return}break;case "t":case "f":if(j=e.match(Ga)){d(e,g);return}}g.b();g.a(new Z(a,b))}}r(tb,E);tb.prototype.name="VariableValue";
function Z(a,b){var d,c=l,g=h,e=h,k=h,j=l;b?d=a:(d=new D,a.add(Va+"(function(){return ").add(d).add("})"));this.execute=function(a,b){var t,v;if(!j){a.c();v=a.charAt(0);switch(v){case "@":(t=a.match(la))?(a.shift(t[1].length),b.J(t[2]),d.add(b.h().ka()+t[2])):f("invalid variable reference.");c=h;break;case "c":(t=a.match(Ca))&&a.shift(t[1].length);c=h;break;case ".":a.shift(1),e=l,c=h}"@"!==v&&d.add(y);j=h}a.c();switch(a.charAt(0)){case ".":e||f("Unexpected '.'.");c=k=e=g=l;a.shift(1);d.add(".");
break;case "[":k||f("Unexpected '['.");c=e=k=h;b.a(new vb(d));return}a.c();(v=a.match(ca))?(v=v[1],La(v),a.shift(v.length),g&&d.add("."),d.add(v),v=h):v=l;g=h;v?c=h:(c||f("Unexpected character."),b.b())}}r(Z,E);Z.prototype.name="ContextSelector";
function vb(a){var b=l;this.execute=function(d,c){var g;d.c();switch(d.charAt(0)){case "[":if(!b){b=h;d.shift(1);g=new D;a.add("[").add(g);c.a(new wb(g,h));return}break;case "]":if(b){b=l;d.shift(1);a.add("]");c.b();return}}f("Unexpected character: '"+d.charAt(0)+"'.")}}r(vb,E);vb.prototype.name="ContextDynamicRefinement";function wb(a,b){this.f=function(){return a};this.G=function(){return new tb(a,b)};this.F=function(a){return new xb(a)}}r(wb,H);wb.prototype.name="ContextExpression";
function xb(a){this.getExpression=function(a){return new wb(a,h)};this.f=function(){return a}}r(xb,K);xb.prototype.name="ContextParenthesizedExpression";function sb(a){this.execute=function(b,d){var c=b.match(ba);c?(c=c[1],b.shift(c.length),d.i("normalizespace")&&(c=c.replace(/\s+/g," ")),d.i("minifyhtml")&&(c=c.replace(ha,"$1$2")),c=c.replace(/\\{/g,"{").replace(/\\#/g,"#").replace(/\n|\r/g,"\\\n"),a.add(x+"('"+c+"');"),d.b()):f("Invalid Character found.")}}r(sb,E);sb.prototype.name="InputTokens";
function rb(a){var b=l;this.execute=function(d,c){var g;switch(d.charAt(0)){case "{":if(!b){b=h;g=new D;d.shift(1);a.add(x+"(");c.i("escapexss")?a.add(Ta+"(").add(g).add(")"):a.add(g);a.add(");");c.a(new Y(g));return}break;case "}":if(b){d.shift(1);c.b();return}}f("Invalid Character.")}}r(rb,E);rb.prototype.name="PrintStatement";
function S(a){var b=new D,d=h,c=new D;a.add("if(").add(b).add("){").add(c).add("}");this.H=function(){return new Y(b)};this.A=function(){return new R(c)};this.N=function(b,c){var k,j=new D;d||f("Continuations are not allowed after {:else}");b.oa()?(d=l,b.shift(7),a.add("else{").add(j).add("}"),c.a(new R(new D))):(k=b.match(Aa))?(b.shift(k[1].length),a.add("else ").add(j),c.b().a(new S(j))):f("Unknown continuation.")}}r(S,G);S.prototype.name="IfStatement";S.prototype.B=function(){return ra};
function pb(a,b){var d=new D,c=l;b.i("removelogs")||a.add("console.log(").add(d).add(");");this.execute=function(a,b){a.c();c?"}"===a.charAt(0)?(a.shift(1),b.b()):f("Invalid character."):(c=h,b.a(new Y(d)))}}r(pb,E);pb.prototype.name="LogStatement";function T(a){var b=new D,d=new D,c=new D;this.K=h;a.add(x).add("(").add(b).add("(").add(d).add(c).add(")").add(");");this.H=function(){return new yb(b,d)};this.A=function(){return new $(c)}}r(T,G);T.prototype.B=function(){return na};T.prototype.name="CallStatement";
function $(a){var b=new Ya(",{","",":","}",null),d=h;this.j=function(){return b};this.C=function(){d&&(d=l,a.add(b));return new zb(b)}}r($,J);$.prototype.name="CallParams";$.prototype.t="p";$.prototype.D=function(){return u};function zb(a){this.j=function(){return a}}r(zb,I);n=zb.prototype;n.name="CallParamDeclaration";n.p=function(){return u};n.q=function(a){return new W(a)};n.n=m();n.o=function(){f("An assignment must be made here.")};
function yb(a,b){var d=l;this.execute=function(c,g){var e;if(!d){if(e=c.match(da))d=h,e=e[1],c.shift(e.length),a.add(B+"."+e),g.z(e);else if(e=c.match(s))d=h,e=e[1],c.shift(e.length),a.add(z+"."+e),g.z(g.P()+"."+e);if(d){g.b();c.c();e=c.charAt(0);"/"!==e&&"}"!==e?g.a(new Z(b,l)):b.add(y);return}f("A valid Namespace must be given.")}f("Invalid Character")}}r(yb,E);yb.prototype.name="CallExpression";
function qb(a){this.execute=function(b,d){var c;if(c=b.match(ja))c=c[1],b.shift(c.length),a.add(x+"('"+c.replace("\\","\\\\").replace(/\r?\n/g,"\\\n").replace("'","\\'")+"');");(c=b.match(za))?(b.shift(c[1].length),d.b()):f("Unexpected character.")}}r(qb,E);qb.prototype.name="TextStatement";
function U(a,b){var d=new D,c=new D,g=new D,e=new D,k=new D;a.add(Ua+"(").add(C+"(").add(d).add(e).add(k).add(")").add(",").add("function("+y+","+Ra+","+A+","+Oa+"){").add(c).add("}").add(g).add(");");b.e.put(Ua,b.d.fa()).put(C,b.d.O());this.H=function(){return new Z(d,l)};this.A=function(){return new Ab(c,e,g,k)}}r(U,G);U.prototype.name="ForeachStatement";U.prototype.B=function(){return pa};
function Ab(a,b,d,c){var g=l,e=l,k=l,j=l;this.execute=function(p,q){var t;p.c();j||(j=h,q.M());switch(p.charAt(0)){case "{":switch(p.charAt(1)){case "s":if(!g&&(!e&&!k)&&(g=h,t=p.match(va))){p.shift(t[1].length);q.a(new Bb(b,d,c,q));return}break;case "v":if(!e&&!k&&(e=h,t=p.match(w))){a.add(q.h());q.a(new O(q.h()));return}break;case "/":q.b();q.T();return}default:k=h,q.a(new R(a))}}}r(Ab,E);Ab.prototype.name="ForeachBodyStatements";
function Bb(a,b,d,c){c.e.put(C,c.d.O());var g=l,e=l;this.execute=function(c,j){c.c();if(g)if("}"===c.charAt(0))e||b.add(",1,0"),c.shift(1),j.b();else{if(!e){var p=c.match(ea);if(p){e=h;p=p[1];c.shift(p.length);var p=0===p.indexOf("a"),q=l,t=c.match(fa);t&&(q=t[1],c.shift(q.length),-1<q.indexOf("i")&&d.add(",1"),q=-1<q.indexOf("n"));b.add(","+(p?1:0)+","+(q?1:0));return}f("Sort direction must be one of 'asc' or 'desc'.")}f("Invalid Character.")}else g=h,p=new D,a.add(",function("+y+"){return ").add(p).add("}"),
j.a(new Z(p,h))}}r(Bb,E);Bb.prototype.name="SortStatement";function eb(){var a={},b={};this.I=function(b){a[b]=h;return this};this.z=function(a){b[a]=h;return this};this.Q=function(a){return b.hasOwnProperty(a)};this.R=function(b){return a.hasOwnProperty(b)};this.pa=function(){for(var d in b)a.hasOwnProperty(d)||f(d+" has not been declared.")}}
function db(a){a=a||{};var b={debug:l,escapexss:h,global:h,minifyhtml:h,normalizespace:h,outputlibrary:"",removelogs:h,useexternal:l,warn:l},d;for(d in a)d in b&&(b[d]=a[d]);this.X=b;this.d=new Xa(b);this.compile=function(a,b,d){(!a||"string"!==typeof a)&&f("input must be a string.");var k=new D;a=new bb(a);var j=new cb(k,this,d);b&&j.na(b);try{for(j.a(new gb(k,j,!!d));0<a.length();)j.Z(a);j.close()}catch(p){f("ERROR while evaluating: "+j.ca().name+"\n   Line  : "+a.ia()+"\n   Column: "+a.ba()+"\nREASON:\n   "+
p)}return k.toString()}}this.XforJS={server:h,getCompiler:function(a){return new db(a)}};}();
